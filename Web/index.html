<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>星幕</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      crossorigin="anonymous"
    />
  </head>

  <body>
    <div id="root"></div>
    <script>
      // 在页面加载时生成与fa-ticket一致的favicon
      document.addEventListener("DOMContentLoaded", function () {
        // 创建canvas元素绘制图标
        const canvas = document.createElement("canvas");
        canvas.width = 32; // favicon标准尺寸
        canvas.height = 32;
        const ctx = canvas.getContext("2d");

        // 创建红色渐变背景（与大麦抢票风格一致）
        const gradient = ctx.createLinearGradient(0, 0, 32, 32);
        gradient.addColorStop(0, "#dc2626"); // 红色
        gradient.addColorStop(1, "#f97316"); // 橙色

        // 绘制圆角矩形背景
        ctx.beginPath();
        const radius = 4; // 圆角大小
        ctx.moveTo(radius, 0);
        ctx.lineTo(32 - radius, 0);
        ctx.arcTo(32, 0, 32, radius, radius);
        ctx.lineTo(32, 32 - radius);
        ctx.arcTo(32, 32, 32 - radius, 32, radius);
        ctx.lineTo(radius, 32);
        ctx.arcTo(0, 32, 0, 32 - radius, radius);
        ctx.lineTo(0, radius);
        ctx.arcTo(0, 0, radius, 0, radius);
        ctx.closePath();
        ctx.fillStyle = gradient;
        ctx.fill();

        // 确保Font Awesome字体加载完成后绘制票形图标
        const checkFontLoad = setInterval(() => {
          // 检查字体是否可用
          ctx.font = '1px "Font Awesome 6 Free"';
          if (ctx.font.includes("Font Awesome")) {
            clearInterval(checkFontLoad);

            // 绘制fa-ticket图标（\uf145是ticket图标的Unicode）
            ctx.fillStyle = "white"; // 图标颜色
            ctx.font = 'bold 18px "Font Awesome 6 Free"'; // 使用Font Awesome字体
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText("\uf145", 16, 16); // 绘制票形图标

            // 将canvas转换为图片并设置为favicon
            const favicon = document.createElement("link");
            favicon.rel = "icon";
            favicon.type = "image/png";
            favicon.href = canvas.toDataURL("image/png");

            // 替换现有favicon（如果有）或添加新的
            const existingFavicon = document.querySelector('link[rel="icon"]');
            if (existingFavicon) {
              existingFavicon.parentNode.replaceChild(favicon, existingFavicon);
            } else {
              document.head.appendChild(favicon);
            }
          }
        }, 100);

        // 超时保护，防止字体加载失败导致无限循环
        setTimeout(() => clearInterval(checkFontLoad), 3000);
      });
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
